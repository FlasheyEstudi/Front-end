<!-- src/app/Child/TipoPago/tipopago.component.html -->
<div class="tipopago-container">
  <div class="card-container">
    <h1 class="main-title">Gestión de Tipos de Pago</h1>

    <div class="top-bar">
      <input type="text" [(ngModel)]="searchTerm" (input)="onSearch()"
             placeholder="Buscar tipo de pago..." class="search-input">
      <button (click)="editMode ? cancelEdit() : toggleForm()" class="btn-primary">
        {{ editMode ? 'Cancelar Edición' : 'Agregar Tipo de Pago' }}
      </button>
    </div>

    <div *ngIf="errorMsg" class="alert error-alert">{{ errorMsg }}</div>
    <div *ngIf="successMsg" class="alert success-alert">{{ successMsg }}</div>

    <div class="form-section">
      <h3 class="form-title">
        {{ editMode ? 'Editar Tipo de Pago' : 'Agregar Nuevo Tipo de Pago' }}
      </h3>
      <div class="form-fields-grid">
        <div>
          <label for="nombre" class="form-label">Nombre:</label>
          <input type="text" id="nombre" [(ngModel)]="nuevoTipoPago.Nombre" name="nombre" required
                 class="form-input">
        </div>
        <div>
          <label for="descripcion" class="form-label">Descripción:</label>
          <textarea id="descripcion" [(ngModel)]="nuevoTipoPago.Descripcion" name="descripcion"
                    class="form-input textarea-height" placeholder="Ingrese una descripción"></textarea>
        </div>
        <div>
          <label for="estado" class="form-label">Estado:</label>
          <select id="estado" [(ngModel)]="nuevoTipoPago.EstadoId" name="estado" required
                  class="form-select">
            <option [ngValue]="null" disabled>-- Seleccione un estado --</option>
            <option *ngFor="let est of estadosLookup" [ngValue]="est.Id">
              {{ est.Nombre }}
            </option>
          </select>
        </div>
      </div>
      <div class="form-actions">
        <button (click)="guardarTipoPago()" class="btn-action">
          {{ editMode ? 'Actualizar' : 'Guardar' }}
        </button>
        <button *ngIf="editMode" (click)="cancelEdit()" class="btn-secondary">
          Cancelar
        </button>
      </div>
    </div>

    <hr class="divider">

    <div class="table-section">
      <h3 class="table-title">Listado de Tipos de Pago</h3>
      <div class="table-responsive">
        <table class="data-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Descripción</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let tipo of filteredTiposDePago">
              <td>{{ tipo.Id }}</td>
              <td>{{ tipo.Nombre }}</td>
              <td>{{ tipo.Descripcion }}</td>
              <td>{{ tipo.Estadonombre || 'Desconocido' }}</td>
              <td class="actions-cell">
                <button class="btn-edit" (click)="editTipoPago(tipo)">Editar</button>
                <button class="btn-delete" (click)="deleteTipoPago(tipo.Id)">Eliminar</button>
              </td>
            </tr>
            <tr *ngIf="filteredTiposDePago.length === 0">
              <td colspan="5" class="no-data-message">
                No hay tipos de pago registrados o no coinciden con la búsqueda.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
