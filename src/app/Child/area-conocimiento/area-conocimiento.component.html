<!-- src/app/Child/area-conocimiento/area-conocimiento.component.html -->
<div class="area-conocimiento-container">
  <h2>Gestión de Áreas de Conocimiento</h2>

  <!-- Mensajes de estado -->
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  <div *ngIf="success" class="alert alert-success">{{ success }}</div>

  <!-- Barra de búsqueda y botón de crear -->
  <div class="controls">
    <input type="text" [(ngModel)]="searchTerm" (input)="filterAreas()" placeholder="Buscar áreas..." class="form-control search-input">
    <button (click)="openModal()" class="btn btn-primary">Crear Nueva Área</button>
  </div>

  <!-- Indicador de carga -->
  <div *ngIf="loading" class="loading">Cargando...</div>

  <!-- Tabla de áreas -->
  <table class="table table-striped" *ngIf="!loading && filteredAreas.length > 0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Descripción</th>
        <th>Fecha Creación</th>
        <th>Fecha Modificación</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let area of filteredAreas">
        <td>{{ area.Id }}</td>
        <td>{{ area.nombre }}</td>
        <td>{{ area.descripcion }}</td>
        <td>{{ area.fechaCreacion | date:'short' }}</td>
        <td>{{ area.fechaModificacion | date:'short' }}</td>
        <td>
          <button (click)="openEditModal(area)" class="btn btn-sm btn-warning">Editar</button>
          <button (click)="deleteAreaConocimiento(area.Id)" class="btn btn-sm btn-danger">Eliminar</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Mensaje si no hay datos -->
  <div *ngIf="!loading && filteredAreas.length === 0" class="no-data">
    No se encontraron áreas de conocimiento.
  </div>
</div>

<!-- Modal para Crear/Editar -->
<div class="modal" [ngClass]="{ 'is-active': showModal }" *ngIf="showModal">
  <div class="modal-background" (click)="closeModal()"></div>
  <div class="modal-content">
    <div class="box">
      <h3>{{ editMode ? 'Editar Área de Conocimiento' : 'Crear Nueva Área de Conocimiento' }}</h3>
      
      <form (ngSubmit)="onSubmit()" #areaForm="ngForm">
        <div class="field">
          <label class="label">Nombre *</label>
          <div class="control">
            <input
              class="input"
              type="text"
              [(ngModel)]="nuevaAreaConocimiento.nombre"
              name="nombre"
              required
              #nombre="ngModel"
            />
          </div>
          <div *ngIf="nombre.invalid && nombre.touched" class="help is-danger">
            El nombre es obligatorio.
          </div>
        </div>

        <div class="field">
          <label class="label">Descripción</label>
          <div class="control">
            <textarea
              class="textarea"
              [(ngModel)]="nuevaAreaConocimiento.descripcion"
              name="descripcion"
            ></textarea>
          </div>
        </div>

        <!-- Mostrar fechas solo en modo edición y si el objeto existe -->
        <div *ngIf="editMode && areaToEdit" class="field">
          <label class="label">Fecha de Creación</label>
          <div class="control">
            <input class="input" type="text" [value]="areaToEdit.fechaCreacion | date:'short'" disabled />
          </div>
        </div>
        <div *ngIf="editMode && areaToEdit" class="field">
          <label class="label">Fecha de Modificación</label>
          <div class="control">
            <input class="input" type="text" [value]="areaToEdit.fechaModificacion | date:'short'" disabled />
          </div>
        </div>

        <div class="field is-grouped">
          <div class="control">
            <button
              type="submit"
              class="button is-link"
              [disabled]="areaForm.invalid || loading"
            >
              {{ editMode ? 'Actualizar' : 'Crear' }}
            </button>
          </div>
          <div class="control">
            <button type="button" class="button is-light" (click)="closeModal()">Cancelar</button>
          </div>
        </div>
      </form>
    </div>
  </div>
  <button class="modal-close is-large" aria-label="close" (click)="closeModal()"></button>
</div>